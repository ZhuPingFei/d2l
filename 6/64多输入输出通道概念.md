这里的都叫做2d卷积，是用nn.Conv2d

3d卷积用来处理视频或者有  深度信息  这个参数的图片



一个3X3矩阵，==二维卷积核==，$k_n和k_w$

每个通道对应一个卷积核，所有通道卷积加和。此时用的多个卷积核放到一起，==三维卷积核==$c_i和k_n和k_w$

需要多个输出通道时，对一个输入用多个三维卷积核。此时就是==多个三维卷积核==$c_o和c_i和k_n和k_w$

# 多个输入通道

当输入包含多个通道时，需要构造一个与输入数据具有相同输入通道数的卷积核，以便与输入数据进行互相关运算。

==当有多个输入通道时，我们的输入就不是一个矩阵，而是一个三维的tensor==

==此时我们用的卷积核也就是三维卷积核==

![image-20220713165202244](D:\论文\截图\image-20220713165202244.png)



输入：前面那个是通道0，后面那个是通道1。

对于每一个通道都有一个卷积核，前面的卷积核给通道0用，后面那个给通道1用。值不需要一样（应该大概率都是不一样的）

各个通道分别和与其对应的通道做卷积操作，然后  按元素相加得到最终结果。

![image-20220713165559728](D:\论文\截图\image-20220713165559728.png)

==$X和W本身是三维张量$==

==$此处X和W有下标，实际为X_{i,:,:}和W_{i,:,:},所以都是是取到三维张量里面的一个矩阵，$==

==$此处表示的是每个输入通道（矩阵）和每个通道对应的卷积核（矩阵），然后Y是他们互相关运算后按元素相加$==



$c_i$  c表示channel，i表示input。

$c_i$用来迭代输入的每一个输入通道



注：此处没有考虑偏移bias，偏移就是一个$c_i$大小的向量





# 多个输出通道

==多输入通道是由图片的channel决定的，如RGB三个通道==

==多输出通道是由卷积核的数目决定的，对于一个图片，每个通道一个卷积核，这个几个通道的卷积核合起来就是一个三维卷积核。==

==多个三维卷积核，决定了有多个输出通道。==

![image-20220713170633510](D:\论文\截图\image-20220713170633510.png)

输入对一个三维卷积核，只会产生一条输出通道。

用多个三维卷积核，每个核产生一个输出通道，这样就会产生多个输出通道。



==此处W是四维张量==

==$此处Y和W有下标，实际为Y_{i,:,:}和W_{i,:,:},所以都是是取到三维张量里面的一个矩阵，$==

==$此处表示的是每个输出通道（矩阵）和每个输入（多个通道合起来）对应的卷积核（三维tensor），根据下标c_o一一对应$==



最后的 Y 也是一个三维tensor，多个二维组成



# 具体干了什么事情

![image-20220713171840193](D:\论文\截图\image-20220713171840193.png)

多输出通道：每个输出通道就是在识别某一个特定的模式，然后把他输出出来

比如上面就是输出通道等于6



多输出通道：假设把这6个输出丢给下一个层，把每个通道里面模式识别然后组合起来，然后按一定权重相加得到组合的模式识别。（比如1X1卷积）



那么原始图片分成多个通道（如RGB）也类似于这样的把特征给到每个通道





一般下面的层都是识别一下局部的纹理，上面的层就是把这些纹理组合起来。



# 1X1卷积层

即有$c_o和c_i$，但是高和宽都是1

==意味着不会识别空间信息，每次只看一个像素。==

作用仅仅是==融合不同通道的信息==

![image-20220713222910469](D:\论文\截图\image-20220713222910469.png)

相当于卷积核没有大小。

但是有好多个，以此来产生多个输出通道



多个输入通道乘以对应==三维卷积==中的各个二维卷积，并加和作为一个==通道输出==

这么好几个1X1的三维卷积，组成了多个通道输出，输出变成三维





只是在输入的通道和输出的通道之间做融合



==实际上等价于==

把输入拉成一个向量，把输入拉成一个$n_h \times n_w$的向量，相当于空间信息就没了

然后通道数拉成feature数，也就是$c_i$

相当于reshape成了一个 矩阵

列数为输入通道数，即为$c_i$

核重新写成$c_o \times c_i$

# ==$相当于输入形状为n_hn_w \times c_i ,权重为c_o \times c_i 的全连接层$==

全连接层不考虑空间维度，只考虑在特征维度输入通道的融合。



# 二维卷积层

![image-20220713225724301](D:\论文\截图\image-20220713225724301.png)

$c_o组三维卷积核，每组三维卷积核有c_i个bias（一个输入通道对一个二维核，一个二维核对一个bias）$

# 总结

![image-20220713164335121](D:\论文\截图\image-20220713164335121.png)

1、输出通道数是卷积层的超参数

事先规定好有==多少==个==三维卷积核==（对每个输入通道有一个卷积核（二维卷积核），这几个卷积核的计算结果相加）

即==$c_o$==的大小，即==$c_o$==个三维卷积核，即==输出通道数==



2、每个输入通道有独立的二维卷积核，所有通道结果相加得到一个输出通道结果

3、每个输出通道有独立的三维卷积核

所以最后的卷积核是一个四维的张量